<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>åº«å­˜ç›¤é»è¡¨</title>
<style>
  /* --- å…¨å±€è¨­å®šï¼šç¢ºä¿å¯¬åº¦è¨ˆç®—åŒ…å«é‚Šæ¡† (é—œéµä¿®æ­£) --- */
  * { box-sizing: border-box; }

  body { 
    font-family: "Microsoft JhengHei", "Heiti TC", sans-serif; 
    margin: 20px; 
    background-color: #f4f4f4; 
  }
  .container {
    max-width: 100%; 
    margin: 0 auto;
    background: white;
    padding: 20px;
  }

  /* --- é ‚éƒ¨æ¨™é¡Œå€ --- */
  .top-header {
    text-align: center; 
    margin-bottom: 20px;
    border-bottom: 3px solid #000;
    padding-bottom: 15px;
    position: relative;
  }

  /* æ¨™é¡Œï¼šæ¯›ç­†å­—é«” */
  #sheetTitle {
    font-family: "Kaiti TC", "STKaiti", "BiauKai", "æ¨™æ¥·é«”", "DFKai-SB", serif; 
    font-size: 48px; 
    font-weight: 900;
    margin: 0;
    line-height: 1.2;
    text-align: center;
  }

  /* æ—¥æœŸï¼šæ‰‹å¯«ç•™ç™½ */
  .date-box {
    position: absolute;
    right: 0;
    bottom: 15px;
    font-size: 18px;
    font-weight: bold;
    color: #000;
  }
  .date-line {
    display: inline-block;
    width: 150px;
    border-bottom: 2px solid #000;
  }

  /* --- è­¦èª --- */
  .slogan {
    text-align: center;
    color: #d9534f;
    font-weight: bold;
    font-size: 20px;
    margin: 10px 0 15px 0;
    padding: 5px;
    background-color: #fff3f3;
    border: 1px dashed #d9534f;
  }

  /* --- è¡¨æ ¼æ ¸å¿ƒè¨­å®š --- */
  table {
    width: 100%;
    border-collapse: collapse;
    border: 3px solid #000; 
    table-layout: fixed; /* å¼·åˆ¶ä¾ç…§è¨­å®šçš„ % åˆ†é…å¯¬åº¦ */
  }
  
  th, td {
    border: 1px solid #000;
    font-size: 19px; /* å­—é«”å¾®èª¿ï¼Œé¿å…éå¤§æ›è¡Œ */
    color: #000;
    vertical-align: middle;
    padding: 0; /* é è¨­æ­¸é›¶ï¼Œç”±å…§éƒ¨å…ƒç´ æ§åˆ¶ */
    height: 50px; 
  }

  /* --- æ¬„ä½å¯¬åº¦æ¯”ä¾‹ (åˆè¨ˆ 100%) --- */
  /* 1. å“å 45% */
  .col-name { 
    width: 45%; 
    text-align: left; 
    padding: 5px 10px; /* å“åéœ€è¦å…§è· */
    font-weight: bold; 
    line-height: 1.3;
    overflow: hidden; /* é˜²æ­¢éé•·æ–‡å­—æ’é–‹ */
  }
  
  /* 2. æ•¸é‡(ç®±) 15% */
  .col-box-header { width: 15%; }
  
  /* 3. æ•¸é‡(åŒ…/ç›’) 15% */
  .col-pack-header { width: 15%; }
  
  /* 4. æ•ˆæœŸ 25% */
  .col-date { 
    width: 25%; 
    text-align: center; 
    font-size: 18px; 
    padding: 5px; 
  }

  /* --- æ•¸é‡æ¬„ä½å…§éƒ¨åˆ†å‰² (Flexbox) --- */
  .split-box {
    display: flex;
    width: 100%;
    height: 100%; 
    align-items: stretch; /* å¼·åˆ¶ç­‰é«˜ */
  }
  
  /* å·¦ï¼šæ‰‹å¯«å€ */
  .split-left {
    flex-grow: 1; /* è‡ªå‹•å¡«æ»¿å‰©é¤˜ç©ºé–“ */
    background-color: #fff;
    border-right: 1px solid #000; 
  }

  /* å³ï¼šå–®ä½å€ */
  .split-right {
    width: 50px; /* å–®ä½å›ºå®šå¯¬åº¦ï¼Œç¢ºä¿æ–‡å­—ä¸æŠ˜è¡Œ */
    min-width: 40px;
    text-align: center;
    font-size: 16px;
    font-weight: bold;
    background-color: #e0e0e0; /* ç°åº• */
    display: flex;
    align-items: center;
    justify-content: center;
    /* ç¢ºä¿åˆ—å°èƒŒæ™¯è‰² */
    -webkit-print-color-adjust: exact;
    print-color-adjust: exact;
  }

  /* --- è¡¨é ­æ¨£å¼ --- */
  .header-row td {
    background-color: #333;
    color: white;
    text-align: center;
    font-weight: normal;
    font-size: 18px;
    padding: 10px; 
    -webkit-print-color-adjust: exact;
  }

  /* --- åŠŸèƒ½å€ --- */
  #loading, #error { text-align: center; padding: 20px; font-size: 18px; }
  #error { color: red; display: none; }
  .no-print { text-align: center; margin-bottom: 20px; }
  .btn-refresh {
    padding: 10px 25px;
    background: #0056b3;
    color: white;
    border: none;
    border-radius: 5px;
    font-size: 16px;
    cursor: pointer;
  }

  /* --- A4 åˆ—å°è¨­å®š --- */
  @media print {
    @page { size: A4; margin: 8mm; }
    body { margin: 0; background: white; }
    .container { box-shadow: none; padding: 0; margin: 0; width: 100%; }
    .no-print { display: none !important; }
    
    table { border: 2px solid #000; }
    th, td { border: 1px solid #000; }
    
    #sheetTitle { font-family: "Kaiti TC", "STKaiti", "BiauKai", "æ¨™æ¥·é«”", serif; }
    .slogan { border: 1px solid #d9534f; color: red !important; }
  }
</style>
</head>
<body>

<div class="container">
  
  <div class="no-print">
    <button class="btn-refresh" onclick="location.reload()">ğŸ”„ æ›´æ–°å“é … (åƒ…æ›´æ–°å“å/æ•ˆæœŸ)</button>
  </div>

  <div id="loading">è®€å– Google Sheet ä¸­...</div>
  <div id="error">è®€å–å¤±æ•—ã€‚</div>

  <div id="contentArea" style="display:none;">
    
    <div class="top-header">
      <h1 id="sheetTitle">åº«å­˜è¡¨</h1> 
      <div class="date-box">
        å¡«è¡¨æ—¥æœŸï¼š<div class="date-line"></div>
      </div>
    </div>

    <div class="slogan">
      â€» å‡ºå…¥åº«è«‹å‹™å¿…æ›´æ”¹æ•¸é‡ â€»
    </div>

    <table>
      <thead>
        <tr class="header-row">
          <td class="col-name">å“å</td>
          <td class="col-box-header">æ•¸é‡ï¼ˆç®±ï¼‰</td>
          <td class="col-pack-header">æ•¸é‡ï¼ˆåŒ…ï¼ç›’ï¼‰</td>
          <td class="col-date">æœ€çŸ­æ•ˆæœŸ</td>
        </tr>
      </thead>
      <tbody id="tableBody">
        </tbody>
    </table>
  </div>
</div>

<script>
  // æ‚¨çš„ Google Sheet CSV é€£çµ
  var csvUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vR6NReikJupU2FoEZ-pliojjbRtxO3rOZ_s39T08AonR1W2oQTe7dNjAzQM48acfFJ6bMFdnef5wDkW/pub?gid=0&single=true&output=csv'; 

  // é˜²æ­¢å¿«å–
  var finalUrl = csvUrl + '&t=' + new Date().getTime();

  fetch(finalUrl)
    .then(response => response.text())
    .then(csvText => {
      const rows = csvText.split('\n');
      const tableBody = document.getElementById('tableBody');
      const titleEl = document.getElementById('sheetTitle');

      // 1. æŠ“å–æ¨™é¡Œ (CSV ç¬¬ 1 åˆ—)
      if (rows.length > 0) {
        let firstRow = rows[0].split(',')[0]; 
        firstRow = firstRow.replace(/^"|"$/g, '').trim(); 
        if(firstRow) titleEl.innerText = firstRow;
      }

      // 2. æŠ“å–è³‡æ–™ (å¾ç¬¬ 3 åˆ—é–‹å§‹)
      for (let i = 2; i < rows.length; i++) {
        let row = rows[i].trim();
        if (!row) continue;
        
        const cols = row.split(',');

        // ç¢ºä¿è‡³å°‘æœ‰è³‡æ–™
        if (cols.length >= 4) { 
          const tr = document.createElement('tr');
          
          // å“å (Column A -> Index 0)
          let name = (cols[0] || "").replace(/^"|"$/g, '');
          
          // æ•ˆæœŸ (å„ªå…ˆæŠ“ Gæ¬„ Index 6, è‹¥ç„¡å‰‡æŠ“ Fæ¬„ Index 5)
          let exp = "";
          if (cols.length > 6) exp = (cols[6] || "").replace(/^"|"$/g, '');
          else if (cols.length > 5) exp = (cols[5] || "").replace(/^"|"$/g, '');

          // ç”Ÿæˆè¡¨æ ¼åˆ—
          tr.innerHTML = `
            <td class="col-name">${name}</td>
            
            <td>
              <div class="split-box">
                <div class="split-left"></div> 
                <div class="split-right">ç®±</div>
              </div>
            </td>
            
            <td>
              <div class="split-box">
                <div class="split-left"></div> 
                <div class="split-right">åŒ…/ç›’</div>
              </div>
            </td>
            
            <td class="col-date">${exp}</td>
          `;
          tableBody.appendChild(tr);
        }
      }

      document.getElementById('loading').style.display = 'none';
      document.getElementById('contentArea').style.display = 'block';
    })
    .catch(err => {
      console.error(err);
      document.getElementById('loading').style.display = 'none';
      document.getElementById('error').style.display = 'block';
    });
</script>

</body>
</html>
